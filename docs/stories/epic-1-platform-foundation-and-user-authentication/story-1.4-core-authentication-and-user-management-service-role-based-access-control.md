# Story 1.4: 核心認證與用戶管理服務 - 角色權限保護

> **🔴 MVP Priority: Phase 1** - 核心安全功能，保護系統數據的基礎
> **⏱️ 預估工作量**: 1-2 天
> **👥 需要角色**: 後端開發者, 前端開發者

## User Story

身為系統，
我想要能夠根據登入使用者的角色來保護頁面和 API 的訪問權限，
以便確保未授權的使用者無法訪問敏感資料或執行未經許可的操作。

## 背景說明
角色權限保護是防止數據洩露和未授權操作的關鍵防線。此故事旨在建立一個可重用的機制，在前後端實施權限控制。

## 技術規格 (初步建議)
*   **前端:** 建立「受保護的路由」高階元件，根據 JWT 檢查認證狀態和角色，並動態顯示/隱藏 UI 元素。
*   **後端 (NestJS):** 使用 `Passport.js` 和 `passport-jwt` 建立 `JwtAuthGuard` 進行 JWT 驗證。建立可重用的 `RolesGuard` 檢查使用者角色。
*   **整合流程:** 前端路由守衛 + 後端 API 守衛，共同實現完整的權限保護。

## 驗收標準
**1. 前端路由保護：**
- 未登入使用者訪問受保護頁面時，重新導向到 `/login`。
- 低權限角色訪問高權限頁面時，顯示「權限不足」頁面。
**2. 後端 API 保護：**
- 未提供有效 JWT 的請求返回 `401 Unauthorized`。
- 角色權限不足的請求返回 `403 Forbidden`。
- 授權成功的請求能正常處理。
**3. 使用者體驗：**
- JWT 過期後，使用者會被自動登出並導向到登入頁。

## 技術債務考量
- **細粒度權限:** MVP 採用基於角色的粗粒度權限控制 (RBAC)。未來可能需要升級為更細粒度的權限系統 (ABAC)，目前的守衛設計應易於擴展。

