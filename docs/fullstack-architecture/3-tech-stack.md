# 3. 技術棧 (Tech Stack)

本章節详细阐述了「IT 專案流程管理平台」的技术选型，并为每一个关键决策提供了清晰的理由。

### 3.1. 技术栈决策过程

在确定最终技术栈之前，我们对几个关键的架构决策点进行了深入的评估和比较。

#### 3.1.1. 架构简化决策：全栈 vs. 分离

**最终选择：Next.js 全栈架构**

| 特性 | Next.js 全栈 (本项目选型) | 分离式架构 (例如 NestJS + Next.js) |
| :--- | :--- | :--- |
| **开发复杂度** | **低** - 单一应用程式与代码库 | **高** - 需要维护两个独立的应用程式和 API 契约 |
| **部署复杂度** | **低** - 单一部署单元，与 Azure App Service 完美契合 | **高** - 需要协调两个服务的部署、网络和安全策略 |
| **团队学习成本** | **低** - 统一的技术栈和开发模式 (TypeScript) | **高** - 需要掌握前后端分离的两种开发范式 |
| **开发速度** | **非常快** - tRPC 实现了零 API 定义成本 | **较慢** - 需要定义 OpenAPI/GraphQL Schema，并维护客户端代码生成 |

**选择理由:** 对于我们的团队规模和快速迭代的业务需求，Next.js 全栈架构能够显著提升开发效率，降低沟通和维护成本，让我们能更专注于实现业务价值。

#### 3.1.2. API 风格决策：tRPC vs. REST/GraphQL

**最终选择：tRPC (集成于 Next.js)**

| 特性 | tRPC (本项目选型) | REST / GraphQL |
| :--- | :--- | :--- |
| **类型安全** | **端到端自动实现** - 无需代码生成 | 需要 OpenAPI/GraphQL Code Generator 来同步类型 |
| **开发体验** | **极致** - 像调用本地函数，自动完成 | 需要使用 Postman, Insomnia 等工具进行调试 |
| **网络开销** | **极低** - 高效的 RPC 调用 | 较高的 HTTP 开销 / 复杂的查询语言 |

**选择理由:** tRPC 提供了无与伦比的开发体验和端到端的类型安全。它消除了传统 API 开发中繁琐的定义、生成和同步类型的过程，让前后端的数据交换如丝般顺滑，极大减少了潜在的 Bug。

### 3.2. 最终技术栈清单

| 分类 | 技术 | 版本 | 用途 | 理由 |
| :--- | :--- | :--- | :--- | :--- |
| **全栈框架** | Next.js | `~14.x` | 全栈应用框架 | 业界领先的 React 框架，提供 App Router、Server Actions 等现代化功能。 |
| **前端语言** | TypeScript | `~5.x` | 应用开发语言 | 提供强大的类型安全，与后端统一，减少运行时错误。 |
| **UI 元件库** | Tailwind CSS | `~3.x` | CSS 框架 | Utility-first 理念提供了极高的开发效率和设计灵活性。 |
| **无头元件** | Radix UI / Headless UI | `~1.x` | 无障碍元件基础 | 提供完全无障碍 (WAI-ARIA) 且功能完备的底层元件，与 Tailwind 完美结合。 |
| **状态管理** | Zustand / Jotai | `~4.x` | 客户端状态管理 | 轻量、简单、无模板代码，比 Redux 更易于 AI 生成和维护。 |
| **API 风格** | tRPC | `~10.x` | 类型安全的 API 层 | 提供端到端的类型安全，极大地提升了开发体验。 |
| **数据库 ORM** | Prisma | `~5.x` | 数据库访问 | 提供最好的 TypeScript 支持，自动生成类型，简化数据库操作。 |
| **数据库** | PostgreSQL | `16` | 主要关系型数据库 | Azure 官方支持，功能强大，稳定可靠，支持 JSONB 等高级特性。 |
| **文件存储** | Azure Blob Storage | N/A | 用户上传文件存储 | Azure 原生集成，安全、可扩展且成本效益高。 |
| **身份验证** | Azure AD B2C | N/A | 企业级身份验证 | 与 Microsoft 生态系统无缝集成，提供强大的安全性和用户管理功能。 |
| **前端测试** | Jest + RTL | `~29.x` | 单元/组件测试 | React 社区的黄金标准，专注于用户行为测试。 |
| **E2E 测试** | Playwright | `~1.x` | 端到端测试 | 由 Microsoft 开发，提供卓越的稳定性和调试体验。 |
| **部署平台** | Azure App Service | N/A | 应用程式托管 | 与 Azure 生态系统深度集成，提供强大的扩展性和管理功能。 |
| **CI/CD** | GitHub Actions | N/A | 持续集成与部署 | 与我们的代码仓库 (GitHub) 原生集成，配置简单，功能强大。 |
| **监控** | Azure Monitor | N/A | 应用程式监控 | Azure 原生服务，提供日志、指标和追踪的统一视图。 |
| **日志** | Azure Log Analytics | N/A | 日志聚合与分析 | 与 Azure Monitor 集成，提供强大的 KQL 查询语言。 |
