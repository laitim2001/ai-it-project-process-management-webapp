# 2025-W50 每週進度 (12月9日 - 12月15日)

## 本週目標
- [x] 完成 FEAT-008: OM Expense 資料導入功能規劃
- [ ] 實施 FEAT-008 後端 API
- [ ] 實施 FEAT-008 前端頁面
- [ ] 建立 Excel → JSON 轉換腳本
- [ ] 測試導入功能

## 完成情況

### 已完成
- ✅ **FEAT-008: OM Expense 資料導入功能 - 規劃階段完成** (12/9)
  - 分析導入資料 Excel 檔案結構
    - 500 行資料，69 個 Header，160 個 Item，9 個 Category，42 個 OpCo
  - 完成 4 份功能規劃文檔：
    - 01-requirements.md (需求規格)
    - 02-technical-design.md (技術設計)
    - 03-implementation-plan.md (實施計劃)
    - 04-progress.md (進度追蹤)
  - 確定設計決策：
    - 唯一性規則：`Header 名稱 + Item 名稱 + OpCo`
    - UI 方案：獨立 Data Import 頁面 (`/data-import`)
    - Rollback 策略：全部 Rollback（任何失敗就全部回滾）
    - 月度記錄：導入時建立 12 個月度記錄（actualAmount = 0）
    - **新增欄位**：`lastFYActualExpense` (Float?) - 上年度實際支出
    - **表單更新**：OM Expense Item 表單新增 "Last year actual expense" 輸入欄位

### 進行中
- ⏳ **FEAT-008: Phase 2 後端 API 開發** - 待開始
- ⏳ **FEAT-008: Phase 3 前端頁面開發** - 待開始

### 未開始
- ⏸️ **FEAT-006: Project Summary Tab** - 規劃完成，待開發

## 技術決策

### 決策 1: lastFYActualExpense 欄位設計
- **選項 A**: Float (必填)
- **選項 B**: Float? (可為空)
- **選擇**: B → 歷史資料可能不完整，允許為空

### 決策 2: 導入失敗策略
- **選項 A**: 全部 Rollback
- **選項 B**: 部分成功
- **選擇**: A → 確保資料一致性，避免不完整狀態

## 下週計劃
- [ ] 完成 FEAT-008 Phase 1: Schema Migration
- [ ] 完成 FEAT-008 Phase 2: 後端 API 開發
- [ ] 完成 FEAT-008 Phase 3: 前端頁面開發
- [ ] 完成 FEAT-008 Phase 4: 資料準備
- [ ] 完成 FEAT-008 Phase 5: 測試驗證

## 風險提示
- ⚠️ 500 筆資料導入可能需要適當的 Transaction timeout 設置
- ⚠️ OpCo 命名不一致問題（如 `R.IT` vs `RIT`）需後續人工處理

## 統計數據
- **代碼行數**: +400 (規劃文檔)
- **文件變更**: 6 個
- **Commits**: 1 次（預計）
- **工作時間**: ~2 小時

## 文件變更清單

### 新增文件
| 文件 | 說明 |
|------|------|
| `claudedocs/1-planning/features/FEAT-008-om-expense-data-import/01-requirements.md` | 需求規格 |
| `claudedocs/1-planning/features/FEAT-008-om-expense-data-import/02-technical-design.md` | 技術設計 |
| `claudedocs/1-planning/features/FEAT-008-om-expense-data-import/03-implementation-plan.md` | 實施計劃 |
| `claudedocs/1-planning/features/FEAT-008-om-expense-data-import/04-progress.md` | 進度追蹤 |
| `docs/import-data-analysis.json` | 導入資料分析結果 |
| `scripts/analyze-import-data.py` | Excel 分析腳本 |

### 修改文件
| 文件 | 說明 |
|------|------|
| `claudedocs/6-ai-assistant/prompts/SITUATION-7-AZURE-DEPLOY-COMPANY.md` | 更新部署文檔 |

---

**維護者**: AI 助手 + 開發團隊
**最後更新**: 2025-12-09
