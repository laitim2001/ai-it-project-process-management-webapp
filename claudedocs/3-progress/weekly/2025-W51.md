# 2025-W51 每週進度 (12月16日 - 12月22日)

## 本週目標
- [x] 建立 `.claude/rules/` 規則框架
- [x] 更新所有子目錄 CLAUDE.md 文件
- [x] 修復 FIX-095 ~ FIX-097 Bug
- [ ] 持續 Azure 環境維護

## 完成情況

### 已完成

#### 12月18日

- ✅ **建立 `.claude/rules/` 規則框架**
  - 創建 10 個規則文件，提供路徑特定的代碼規範
  - 使用 YAML frontmatter 定義 `applies_to` 路徑
  - 規則文件列表：
    - `index.md` - 規則索引和使用指南
    - `frontend.md` - Next.js App Router 頁面規範
    - `components.md` - React 組件規範
    - `ui-design-system.md` - shadcn/ui 設計系統規範
    - `backend-api.md` - tRPC 後端 API 規範
    - `database.md` - Prisma 資料庫規範
    - `i18n.md` - 國際化規範
    - `typescript.md` - TypeScript 約定
    - `scripts.md` - 開發腳本規範
    - `documentation.md` - 文檔規範

- ✅ **更新所有子目錄 CLAUDE.md 文件 (7 個)**
  - 每個文件都添加了對應的 `.claude/rules/` 引用
  - 經過詳細分析後才進行更新，內容完整
  - 更新的文件：
    1. `apps/web/src/components/CLAUDE.md` → `components.md`
    2. `apps/web/src/components/ui/CLAUDE.md` → `ui-design-system.md`
    3. `packages/api/src/routers/CLAUDE.md` → `backend-api.md`
    4. `packages/api/src/lib/CLAUDE.md` → `backend-api.md`
    5. `packages/db/prisma/CLAUDE.md` → `database.md`
    6. `scripts/CLAUDE.md` → `scripts.md`
    7. `claudedocs/CLAUDE.md` → `documentation.md`

- ✅ **FIX-095: Middleware Route Protection 修復**
  - 問題：路由保護邏輯不完整
  - 解決：增強 middleware.ts 路由保護

- ✅ **FIX-096: Layout Hydration Error 修復**
  - 問題：Layout 組件 hydration 錯誤
  - 解決：修正 layout.tsx 結構

- ✅ **FIX-097: href Template Literal Syntax 修復**
  - 問題：href 使用普通字串而非模板字面量
  - 解決：修正 projects/[id]/edit 和 proposals/[id] 頁面的 href

### 進行中
- ⏳ Azure 環境持續監控

### 未開始
- ⏸️ FEAT-006: Project Summary Tab

## 技術決策

### 決策 1: `.claude/rules/` 框架設計
- **背景**: 需要統一的代碼規範，讓 AI 助手在不同目錄工作時能遵循一致的標準
- **選擇**: 使用獨立規則文件 + YAML frontmatter 定義適用路徑
- **理由**:
  - 清晰的關注點分離（每個規則文件專注一個領域）
  - YAML frontmatter 支持 glob 模式匹配
  - 可在 CLAUDE.md 中引用，建立雙向連結

### 決策 2: CLAUDE.md 更新策略
- **背景**: 原有 CLAUDE.md 內容較簡短，需要豐富化
- **選擇**: 先分析目錄結構，再更新內容
- **理由**: 確保內容準確反映當前代碼狀態，避免過時信息

## 下週計劃
- [ ] 考慮 FEAT-006: Project Summary Tab 開發
- [ ] 持續 Azure 環境維護
- [ ] 代碼品質改進

## 風險提示
- ⚠️ 無重大風險

## 統計數據
- **新增文件**: 13 個 (10 rules + 3 FIX docs)
- **修改文件**: 22 個
- **代碼行數**: +3,544 / -1,040
- **Commits**: 待提交

## 文件變更清單

### 新增文件
```
.claude/rules/
├── index.md
├── frontend.md
├── components.md
├── ui-design-system.md
├── backend-api.md
├── database.md
├── i18n.md
├── typescript.md
├── scripts.md
└── documentation.md

claudedocs/4-changes/bug-fixes/
├── FIX-095-middleware-route-protection-incomplete.md
├── FIX-096-layout-hydration-error.md
└── FIX-097-href-template-literal-syntax.md
```

### 修改文件
- `CLAUDE.md` - 根目錄更新
- `apps/web/src/components/CLAUDE.md`
- `apps/web/src/components/ui/CLAUDE.md`
- `packages/api/src/routers/CLAUDE.md`
- `packages/api/src/lib/CLAUDE.md`
- `packages/db/prisma/CLAUDE.md`
- `scripts/CLAUDE.md`
- `claudedocs/CLAUDE.md`
- `apps/web/src/middleware.ts`
- `apps/web/src/app/[locale]/layout.tsx`
- `apps/web/src/app/layout.tsx`
- `apps/web/src/auth.config.ts`
- `apps/web/src/app/[locale]/projects/[id]/edit/page.tsx`
- `apps/web/src/app/[locale]/proposals/[id]/page.tsx`

---

**維護者**: AI 助手 + 開發團隊
**最後更新**: 2025-12-18
