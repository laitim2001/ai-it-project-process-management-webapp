# ==============================================================================
# IT 專案流程管理平台 - 環境變數樣板
# ==============================================================================
#
# 使用說明:
# 1. 複製此檔案為 .env: cp .env.example .env
# 2. 填寫所有標記為 "REQUIRED" 的變數
# 3. "OPTIONAL" 變數可以保持預設值或根據需求調整
# 4. 不要將 .env 檔案提交到版本控制系統
#
# ==============================================================================

# ------------------------------------------------------------------------------
# 環境設定 (Environment Configuration)
# ------------------------------------------------------------------------------
NODE_ENV=development                    # development | staging | production
APP_NAME="IT Project Process Management Platform"
APP_URL=http://localhost:3000           # 應用程式的基礎 URL

# ------------------------------------------------------------------------------
# 資料庫 (Database)
# ------------------------------------------------------------------------------
# 本地開發環境 (使用 Docker Compose)
DATABASE_URL="postgresql://postgres:localdev123@localhost:5432/itpm_dev"

# Azure 開發環境 (如使用 Azure Database for PostgreSQL)
# DATABASE_URL="postgresql://[username]:[password]@[server].postgres.database.azure.com:5432/[database]?sslmode=require"

# Prisma 相關
# SHADOW_DATABASE_URL=""                # 僅在生產環境進行 migration 時需要

# ------------------------------------------------------------------------------
# NextAuth.js 認證 (Authentication)
# ------------------------------------------------------------------------------
# REQUIRED: NextAuth 密鑰 (使用以下指令生成: openssl rand -base64 32)
NEXTAUTH_SECRET="GENERATE_WITH_OPENSSL_RAND_BASE64_32"

# REQUIRED: NextAuth 應用程式 URL
NEXTAUTH_URL="http://localhost:3000"

# Session 設定
NEXTAUTH_SESSION_MAX_AGE=86400          # 24 小時 (秒)

# ------------------------------------------------------------------------------
# Azure AD B2C (企業級身份驗證)
# ------------------------------------------------------------------------------
# REQUIRED: 在 Azure Portal 中創建 Azure AD B2C Tenant 後獲取

# B2C Tenant 設定
AZURE_AD_B2C_TENANT_NAME="yourtenantname"                    # 例如: contoso
AZURE_AD_B2C_TENANT_ID="your-tenant-id-guid"                 # Tenant ID (GUID)
AZURE_AD_B2C_DOMAIN="${AZURE_AD_B2C_TENANT_NAME}.b2clogin.com"

# B2C 應用程式註冊
AZURE_AD_B2C_CLIENT_ID="your-client-id-guid"                 # Application (client) ID
AZURE_AD_B2C_CLIENT_SECRET="your-client-secret"              # Client secret value

# B2C User Flows (需在 Azure Portal 中創建)
AZURE_AD_B2C_PRIMARY_USER_FLOW="B2C_1_signupsignin"         # 註冊/登入流程
AZURE_AD_B2C_PROFILE_EDIT_FLOW="B2C_1_profileediting"       # 個人資料編輯流程 (OPTIONAL)
AZURE_AD_B2C_PASSWORD_RESET_FLOW="B2C_1_passwordreset"      # 密碼重設流程 (OPTIONAL)

# B2C API Scopes
AZURE_AD_B2C_SCOPE="openid profile email offline_access"

# ------------------------------------------------------------------------------
# Azure 服務 (Azure Services)
# ------------------------------------------------------------------------------

# Azure Blob Storage (檔案上傳: 報價單、發票)
# REQUIRED in production
AZURE_STORAGE_ACCOUNT_NAME="yourstorageaccountname"
AZURE_STORAGE_ACCOUNT_KEY="your-storage-account-key"
AZURE_STORAGE_CONNECTION_STRING="DefaultEndpointsProtocol=https;AccountName=...;AccountKey=...;EndpointSuffix=core.windows.net"

# Blob Storage Containers
AZURE_STORAGE_CONTAINER_QUOTES="quotes"                     # 報價單容器
AZURE_STORAGE_CONTAINER_INVOICES="invoices"                 # 發票容器

# Azure Key Vault (生產環境密鑰管理)
# OPTIONAL: 僅在生產環境使用
# AZURE_KEY_VAULT_NAME="your-keyvault-name"
# AZURE_KEY_VAULT_URI="https://your-keyvault-name.vault.azure.net/"

# Azure Application Insights (監控與日誌)
# OPTIONAL: 建議在 Staging 和 Production 啟用
# AZURE_APP_INSIGHTS_CONNECTION_STRING="InstrumentationKey=...;IngestionEndpoint=...;LiveEndpoint=..."
# AZURE_APP_INSIGHTS_INSTRUMENTATION_KEY="your-instrumentation-key"

# ------------------------------------------------------------------------------
# Email 服務 (SendGrid)
# ------------------------------------------------------------------------------
# REQUIRED: 用於發送通知郵件

SENDGRID_API_KEY="your-sendgrid-api-key"
SENDGRID_FROM_EMAIL="noreply@yourdomain.com"               # 發件人地址 (需驗證)
SENDGRID_FROM_NAME="IT Project Management"

# Email Templates (SendGrid Dynamic Template IDs)
# OPTIONAL: 如使用 SendGrid Dynamic Templates
# SENDGRID_TEMPLATE_PROPOSAL_SUBMITTED="d-xxxxx"
# SENDGRID_TEMPLATE_PROPOSAL_APPROVED="d-xxxxx"
# SENDGRID_TEMPLATE_PROPOSAL_REJECTED="d-xxxxx"
# SENDGRID_TEMPLATE_MORE_INFO_REQUIRED="d-xxxxx"

# 本地開發: 使用 Mailhog 代替 SendGrid (SMTP)
# SMTP_HOST=localhost
# SMTP_PORT=1025
# SMTP_USER=""
# SMTP_PASSWORD=""

# ------------------------------------------------------------------------------
# Redis (Session & Caching)
# ------------------------------------------------------------------------------
# OPTIONAL: 用於 Session 存儲和快取

REDIS_URL="redis://localhost:6379"                          # 本地開發
# REDIS_URL="rediss://[password]@[hostname]:6380"           # Azure Cache for Redis

# ------------------------------------------------------------------------------
# API 速率限制 (Rate Limiting)
# ------------------------------------------------------------------------------
# OPTIONAL: 保護 API 免受濫用

RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX_REQUESTS=100                                 # 每個時間窗口的最大請求數
RATE_LIMIT_WINDOW_MS=60000                                  # 時間窗口 (毫秒, 60000 = 1分鐘)

# ------------------------------------------------------------------------------
# 日誌與監控 (Logging & Monitoring)
# ------------------------------------------------------------------------------

LOG_LEVEL=info                                               # error | warn | info | debug | trace
LOG_FORMAT=json                                              # json | pretty

# ------------------------------------------------------------------------------
# 前端相關 (Frontend)
# ------------------------------------------------------------------------------
# Next.js Public 環境變數 (可在瀏覽器端存取, 需要 NEXT_PUBLIC_ 前綴)

NEXT_PUBLIC_APP_NAME="${APP_NAME}"
NEXT_PUBLIC_APP_VERSION="1.0.0"
NEXT_PUBLIC_ENVIRONMENT="${NODE_ENV}"

# Feature Flags (功能開關)
NEXT_PUBLIC_FEATURE_AI_ASSISTANT=false                      # Epic 9: AI 功能 (Post-MVP)
NEXT_PUBLIC_FEATURE_EXTERNAL_INTEGRATION=false              # Epic 10: 外部整合 (Post-MVP)

# ------------------------------------------------------------------------------
# 開發工具 (Development Tools)
# ------------------------------------------------------------------------------

# Prisma Studio
# PRISMA_STUDIO_PORT=5555

# 調試模式
DEBUG=false                                                  # 啟用詳細調試日誌
VERBOSE_LOGGING=false

# ------------------------------------------------------------------------------
# 測試環境 (Testing)
# ------------------------------------------------------------------------------
# 測試資料庫 URL (使用獨立的測試資料庫)
TEST_DATABASE_URL="postgresql://postgres:localdev123@localhost:5432/itpm_test"

# E2E 測試設定
PLAYWRIGHT_TEST_BASE_URL="http://localhost:3000"

# ------------------------------------------------------------------------------
# CI/CD (Continuous Integration/Deployment)
# ------------------------------------------------------------------------------
# 這些變數通常在 GitHub Actions 或 Azure DevOps 中設定

# AZURE_CREDENTIALS=""                                       # Azure Service Principal JSON
# AZURE_CONTAINER_REGISTRY=""                                # ACR 名稱
# AZURE_WEBAPP_NAME=""                                       # App Service 名稱

# ------------------------------------------------------------------------------
# 第三方整合 (Third-Party Integrations) - Future Use
# ------------------------------------------------------------------------------

# ERP 系統整合 (Epic 10)
# ERP_API_BASE_URL=""
# ERP_API_KEY=""

# HR 系統整合 (Epic 10)
# HR_API_BASE_URL=""
# HR_API_KEY=""

# ------------------------------------------------------------------------------
# 安全性 (Security)
# ------------------------------------------------------------------------------

# CORS 設定
CORS_ORIGIN="http://localhost:3000"                         # 多個來源用逗號分隔

# CSP (Content Security Policy)
# CSP_DIRECTIVES="default-src 'self'; script-src 'self' 'unsafe-inline';"

# ------------------------------------------------------------------------------
# 其他設定 (Miscellaneous)
# ------------------------------------------------------------------------------

# 時區設定
TZ=Asia/Taipei

# 分頁預設值
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# 檔案上傳限制
MAX_FILE_SIZE_MB=10                                          # 單個檔案最大 10MB
ALLOWED_FILE_TYPES=".pdf,.docx,.xlsx,.png,.jpg"             # 允許的檔案類型
